<template name="participants">
  {{> collectionByRecurringEvent
    allRoute="participants"
    categoryRoute="participantsByEvent"
    newRoute="participantsNew"
    title=title
    emptyText="Pas de participants."
    items=participants
    itemTemplate="_participant"
  }}
</template>

<template name="_participant">
  <a class="collection-item participant clearfix" href="{{pathFor 'participantsEdit'}}">
    {{lastName}}, {{firstName}}
    {{#if isActiveRoute regex="participants$"}}
    <div>
      {{#each recurringEvents}}
        <span class="tag shades-text text-white grey darken-1">{{name}}</span>
      {{/each}}
    </div>
    {{/if}}
  </a>
</template>

<template name="participantsNew">
  <div class="row">
    <div class="col-xs-12">
      {{>_participantsForm}}
    </div>
  </div>
</template>

<template name="participantsEdit">
  <div class="row">
    <div class="col-xs-12">
      {{>_participantsForm}}
    </div>
  </div>
</template>

<template name="_participantsForm">
  {{#autoForm id="participantForm" collection=collection doc=participant type=operation}}
    <div class="row">
      <div class="input-field col s12 m6">
        {{> afQuickField name='lastName'}}
      </div>
      <div class="input-field col s12 m6">
        {{> afQuickField name='firstName'}}
      </div>
    </div>
    <div class="row">
      <div class="col s12">
        <h5>Evènements récurrents</h5>
      </div>
      <div class="col s12">
        <p class="blue-text">Cochez les évènements récuurrents auxquels cette personne participe.</p>
        {{> afQuickField name='recurringEventsIds' label=false type="select-checkbox" options=getRecurringEvents}}
      </div>
    </div>
    {{> _submit}}
  {{/autoForm}}
</template>
